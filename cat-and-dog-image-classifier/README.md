# Instructions  
URL: [https://www.freecodecamp.org/learn/machine-learning-with-python/machine-learning-with-python-projects/cat-and-dog-image-classifier](https://www.freecodecamp.org/learn/machine-learning-with-python/machine-learning-with-python-projects/cat-and-dog-image-classifier)  
**次のプロジェクトはGoogle Colaboratoryを使って取り組むことになります。**

**そのリンクにアクセスした後、ノートブックを自分のアカウントにコピーするか、ローカルに保存してください。プロジェクトを完成させ、テストに合格したら、以下にプロジェクトのリンクを提出してください。Google Colaboratoryのリンクを提出する場合は、「リンクを知っている全員がアクセスできる」ようにリンクの共有設定をオンにしてください。**

**現在、機械学習カリキュラムのインタラクティブな教材を開発中です。現時点では、この認定のビデオチャレンジを進めることができます。また、実際のプロジェクトに取り組む際と同様に、追加の学習リソースを探す必要があるかもしれません。**

このチャレンジでは、犬と猫の画像を分類するコードを完成させます。TensorFlow 2.0とKerasを使用して、犬と猫の画像を少なくとも63%の精度で正しく分類する畳み込みニューラルネットワークを作成します。（精度を70%に達成すると追加のクレジットが得られます！）

一部のコードは既に与えられていますが、このチャレンジを完了するためには、自分でコードを埋める必要があります。各テキストセルに記載された指示を読み、どのコードセルに何をする必要があるかを把握してください。

最初のコードセルは必要なライブラリをインポートします。2番目のコードセルはデータをダウンロードし、重要な変数を設定します。3番目のセルが、最初に自分でコードを書く場所です。

ダウンロードされるデータセットのファイル構成は以下のようになっています（テストディレクトリにはサブディレクトリがなく、画像にはラベルが付いていないことに注意してください）:

```python
cats_and_dogs
|__ train:
    |______ cats: [cat.0.jpg, cat.1.jpg ...]
    |______ dogs: [dog.0.jpg, dog.1.jpg ...]
|__ validation:
    |______ cats: [cat.2000.jpg, cat.2001.jpg ...]
    |______ dogs: [dog.2000.jpg, dog.2001.jpg ...]
|__ test: [1.jpg, 2.jpg ...]
```

エポック数やバッチサイズを調整することもできますが、必須ではありません。

以下の指示は、特定のセル番号に対応しています（# 3などのコメントがセルの上部に記されています）。

**セル3:**
あなたの番です！このセル内の各変数を正しく設定してください（それらが `None` にならないように）。3つの画像データセット（train、validation、test）それぞれに対して画像ジェネレータを作成します。ImageDataGeneratorを使用して、画像を読み取り/デコードし、浮動小数点テンソルに変換します。このとき、テンソルの値を0から255の範囲から0から1の範囲にリスケールするために `rescale` 引数を使用し、それ以外の引数は今のところ使用しません。

- _data_gen変数には、`flow_from_directory` メソッドを使用します。バッチサイズ、ディレクトリ、ターゲットサイズ (IMG_HEIGHT, IMG_WIDTH)、クラスモード、その他必要な引数を渡します。test_data_genが最も難しいでしょう。test_data_genについては、`flow_from_directory` メソッドに `shuffle=False` を渡すことを忘れないでください。これにより、最終的な予測がテストの期待する順序に保たれます。また、ディレクトリ構造をよく観察するとよいでしょう。

コードを実行すると、次のような出力が表示されるはずです:

```vbnet
vbnetコードをコピーする
Found 2000 images belonging to 2 classes.
Found 1000 images belonging to 2 classes.
Found 50 images belonging to 1 class.

```

**セル4:**`plotImages` 関数は、画像と確率リストをプロットするために何度か使用されます。このコードは提供されています。`train_data_gen` 変数を正しく作成した場合、このセルを実行すると、5つのランダムなトレーニング画像がプロットされます。

**セル5:**`ImageDataGenerator` を使用して `train_image_generator` を再作成します。トレーニング例が少ないため、オーバーフィッティングのリスクがあります。この問題を解決する1つの方法は、既存のトレーニング例からランダムな変換を使用してより多くのトレーニングデータを作成することです。4〜6個のランダムな変換を `ImageDataGenerator` の引数として追加してください。以前と同じようにリスケールを行ってください。

**セル6:**
このセルでは何もする必要はありません。`train_data_gen` は、先ほどの新しい `train_image_generator` を使用して再作成されます。そして、単一の画像が異なるバリエーションを使用して5回プロットされます。

**セル7:**
このセルでは、クラス確率を出力するニューラルネットワークのモデルを作成します。Kerasの `Sequential` モデルを使用します。おそらく、`Conv2D` と `MaxPooling2D` 層のスタックと、ReLU活性化関数で活性化される完全結合層を含むでしょう。

モデルをコンパイルし、オプティマイザと損失を設定するための引数を渡します。また、`metrics=['accuracy']` を渡して、各トレーニングエポックでトレーニングおよび検証の精度を表示します。

**セル8:**
モデルの `fit` メソッドを使用してネットワークをトレーニングします。引数として、`x`, `steps_per_epoch`, `epochs`, `validation_data`, `validation_steps` を渡すことを忘れないでください。

**セル9:**
このセルを実行して、モデルの精度と損失を視覚化します。

**セル10:**
いよいよ新しい画像が猫か犬かを予測する時です。

このセルでは、各テスト画像 (test_data_genから) が猫か犬かの確率を取得します。`probabilities` は整数のリストでなければなりません。

`plotImages` 関数を呼び出し、テスト画像と各テスト画像に対応する確率を渡します。

このセルを実行すると、すべての50のテスト画像が表示され、それぞれに「猫」または「犬」としての確信度のパーセンテージが表示されます。精度は、前のセルを実行した後に表示されたグラフの精度に対応します。より多くのトレーニング画像があれば、精度が向上する可能性があります。

**セル11:**
この最後のセルを実行して、チャレンジに合格したか、さらに挑戦が必要かを確認します。
